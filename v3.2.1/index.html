<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>ChaosTools.jl · ChaosTools.jl</title><meta name="title" content="ChaosTools.jl · ChaosTools.jl"/><meta property="og:title" content="ChaosTools.jl · ChaosTools.jl"/><meta property="twitter:title" content="ChaosTools.jl · ChaosTools.jl"/><meta name="description" content="Documentation for ChaosTools.jl."/><meta property="og:description" content="Documentation for ChaosTools.jl."/><meta property="twitter:description" content="Documentation for ChaosTools.jl."/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script><link href="https://fonts.googleapis.com/css?family=Montserrat|Source+Code+Pro&amp;display=swap" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>ChaosTools.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>ChaosTools.jl</a><ul class="internal"><li><a class="tocitem" href="#DynamicalSystemsBase.jl-reference"><span>DynamicalSystemsBase.jl reference</span></a></li></ul></li><li><a class="tocitem" href="orbitdiagram/">Orbit diagrams</a></li><li><a class="tocitem" href="lyapunovs/">Lyapunov Exponents</a></li><li><a class="tocitem" href="chaos_detection/">Detecting &amp; Categorizing Chaos</a></li><li><a class="tocitem" href="dimreduction/">Dimensionality reduction</a></li><li><a class="tocitem" href="periodicity/">Fixed points &amp; Periodicity</a></li><li><a class="tocitem" href="rareevents/">Rare events</a></li><li><a class="tocitem" href="references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>ChaosTools.jl</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>ChaosTools.jl</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaDynamics/ChaosTools.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaDynamics/ChaosTools.jl/blob/main/docs/src/index.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="ChaosTools.jl"><a class="docs-heading-anchor" href="#ChaosTools.jl">ChaosTools.jl</a><a id="ChaosTools.jl-1"></a><a class="docs-heading-anchor-permalink" href="#ChaosTools.jl" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ChaosTools" href="#ChaosTools"><code>ChaosTools</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p><strong>ChaosTools.jl</strong></p><p><a href="https://juliadynamics.github.io/DynamicalSystemsDocs.jl/chaostools/dev/"><img src="https://img.shields.io/badge/docs-dev-lightblue.svg" alt="docsdev"/></a> <a href="https://juliadynamics.github.io/DynamicalSystemsDocs.jl/chaostools/stable/"><img src="https://img.shields.io/badge/docs-stable-blue.svg" alt="docsstable"/></a> <a href="https://link.springer.com/book/10.1007/978-3-030-91032-7"><img src="https://img.shields.io/badge/DOI-10.1007%2F978--3--030--91032--7-purple" alt/></a> <a href="https://github.com/JuliaDynamics/ChaosTools.jl/actions?query=workflow%3ACI"><img src="https://github.com/JuliaDynamics/ChaosTools.jl/workflows/CI/badge.svg" alt="CI"/></a> <a href="https://codecov.io/gh/JuliaDynamics/ChaosTools.jl"><img src="https://codecov.io/gh/JuliaDynamics/ChaosTools.jl/branch/main/graph/badge.svg" alt="codecov"/></a> <a href="https://pkgs.genieframework.com?packages=ChaosTools"><img src="https://shields.io/endpoint?url=https://pkgs.genieframework.com/api/v1/badge/ChaosTools" alt="Package Downloads"/></a></p><p>A Julia module that offers various tools for analysing nonlinear dynamics and chaotic behaviour. It can be used as a standalone package, or as part of <a href="https://juliadynamics.github.io/DynamicalSystemsDocs.jl/dynamicalsystems/dev/">DynamicalSystems.jl</a>.</p><p>To install it, run <code>import Pkg; Pkg.add(&quot;ChaosTools&quot;)</code>.</p><p>All further information is provided in the documentation, which you can either find online or build locally by running the <code>docs/make.jl</code> file.</p><p><em>ChaosTools.jl is the jack-of-all-trades package of the DynamicalSystems.jl library: methods that are not extensive enough to be a standalone package are added here. You should see the full DynamicalSystems.jl library for other packages that may contain functionality you are looking for but did not find in ChaosTools.jl.</em></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/ChaosTools.jl/blob/ef7f1bfd99556ce0104d81ba9ebc1a5acbd40f4c/src/ChaosTools.jl#L4-L21">source</a></section></article><div class="admonition is-info"><header class="admonition-header">Accompanying textbook</header><div class="admonition-body"><p>A good background for understanding the methods of ChaosTools.jl is the following textbook: <a href="https://link.springer.com/book/10.1007/978-3-030-91032-7">Nonlinear Dynamics</a>, Datseris &amp; Parlitz, Springer 2022.</p></div></div><h2 id="DynamicalSystemsBase.jl-reference"><a class="docs-heading-anchor" href="#DynamicalSystemsBase.jl-reference">DynamicalSystemsBase.jl reference</a><a id="DynamicalSystemsBase.jl-reference-1"></a><a class="docs-heading-anchor-permalink" href="#DynamicalSystemsBase.jl-reference" title="Permalink"></a></h2><p>As many docstrings in ChaosTools.jl point to the different <code>DynamicalSystem</code> types, they are also provided here for reference.</p><ul><li><a href="#DynamicalSystemsBase.DynamicalSystem"><code>DynamicalSystem</code></a></li><li><a href="#DynamicalSystemsBase.DeterministicIteratedMap"><code>DeterministicIteratedMap</code></a></li><li><a href="#DynamicalSystemsBase.CoupledODEs"><code>CoupledODEs</code></a></li><li><a href="#DynamicalSystemsBase.CoreDynamicalSystem"><code>CoreDynamicalSystem</code></a></li><li><a href="#DynamicalSystemsBase.StroboscopicMap"><code>StroboscopicMap</code></a></li><li><a href="#DynamicalSystemsBase.PoincareMap"><code>PoincareMap</code></a></li><li><a href="#DynamicalSystemsBase.TangentDynamicalSystem"><code>TangentDynamicalSystem</code></a></li><li><a href="#DynamicalSystemsBase.ParallelDynamicalSystem"><code>ParallelDynamicalSystem</code></a></li><li><a href="#DynamicalSystemsBase.ProjectedDynamicalSystem"><code>ProjectedDynamicalSystem</code></a></li><li><a href="@ref"><code>reinit!</code></a></li></ul><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DynamicalSystemsBase.DynamicalSystem" href="#DynamicalSystemsBase.DynamicalSystem"><code>DynamicalSystemsBase.DynamicalSystem</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">DynamicalSystem</code></pre><p><code>DynamicalSystem</code> is an abstract supertype encompassing all concrete implementations of what counts as a &quot;dynamical system&quot; in the DynamicalSystems.jl library.</p><p><strong><em>All concrete implementations of <code>DynamicalSystem</code> can be iteratively evolved in time via the <a href="@ref"><code>step!</code></a> function.</em></strong> Hence, most library functions that evolve the system will mutate its current state and/or parameters. See the documentation online for implications this has for parallelization.</p><p><code>DynamicalSystem</code> is further separated into two abstract types: <code>ContinuousTimeDynamicalSystem, DiscreteTimeDynamicalSystem</code>. The simplest and most common concrete implementations of a <code>DynamicalSystem</code> are <a href="#DynamicalSystemsBase.DeterministicIteratedMap"><code>DeterministicIteratedMap</code></a> or <a href="#DynamicalSystemsBase.CoupledODEs"><code>CoupledODEs</code></a>.</p><p><strong>Description</strong></p><p>A <code>DynamicalSystem</code> <strong>represents the time evolution of a state in a state space</strong>. It mainly encapsulates three things:</p><ol><li>A state, typically referred to as <code>u</code>, with initial value <code>u0</code>. The space that <code>u</code> occupies is the state space of <code>ds</code> and the length of <code>u</code> is the dimension of <code>ds</code> (and of the state space).</li><li>A dynamic rule, typically referred to as <code>f</code>, that dictates how the state evolves/changes with time when calling the <a href="@ref"><code>step!</code></a> function. <code>f</code> is typically a standard Julia function, see the online documentation for examples.</li><li>A parameter container <code>p</code> that parameterizes <code>f</code>. <code>p</code> can be anything, but in general it is recommended to be a type-stable mutable container.</li></ol><p>In sort, any set of quantities that change in time can be considered a dynamical system, however the concrete subtypes of <code>DynamicalSystem</code> are much more specific in their scope. Concrete subtypes typically also contain more information than the above 3 items.</p><p>In this scope dynamical systems have a known dynamic rule <code>f</code>. Finite <em>measured</em> or <em>sampled</em> data from a dynamical system are represented using <a href="@ref"><code>StateSpaceSet</code></a>. Such data are obtained from the <a href="@ref"><code>trajectory</code></a> function or from an experimental measurement of a dynamical system with an unknown dynamic rule.</p><p>See also the DynamicalSystems.jl tutorial online for examples making dynamical systems.</p><p><strong>Integration with ModelingToolkit.jl</strong></p><p>Dynamical systems that have been constructed from <code>DEProblem</code>s that themselves have been constructed from ModelingToolkit.jl keep a reference to the symbolic model and all symbolic variables. Accessing a <code>DynamicalSystem</code> using symbolic variables is possible via the functions <a href="@ref"><code>observe_state</code></a>, <a href="@ref"><code>set_state!</code></a>, <a href="@ref"><code>current_parameter</code></a> and <a href="@ref"><code>set_parameter!</code></a>. The referenced MTK model corresponding to the dynamical system can be obtained with <code>model = referrenced_sciml_model(ds::DynamicalSystem)</code>.</p><p>See also the DynamicalSystems.jl tutorial online for an example.</p><div class="admonition is-category-warn"><header class="admonition-header">ModelingToolkit.jl v9</header><div class="admonition-body"><p>In ModelingToolkit.jl v9 the default <code>split</code> behavior of the parameter container is <code>true</code>. This means that the parameter container is no longer a <code>Vector{Float64}</code> by default, which means that you cannot use integers to access parameters. It is recommended to keep <code>split = true</code> (default) and only access parameters via their symbolic parameter binding. Use <code>structural_simplify(sys; split = false)</code> to allow accessing parameters with integers again.</p></div></div><p><strong>API</strong></p><p>The API that <code>DynamicalSystem</code> employs is composed of the functions listed below. Once a concrete instance of a subtype of <code>DynamicalSystem</code> is obtained, it can queried or altered with the following functions.</p><p>The main use of a concrete dynamical system instance is to provide it to downstream functions such as <code>lyapunovspectrum</code> from ChaosTools.jl or <code>basins_of_attraction</code> from Attractors.jl. A typical user will likely not utilize directly the following API, unless when developing new algorithm implementations that use dynamical systems.</p><p><strong>API - obtain information</strong></p><ul><li><code>ds(t)</code> with <code>ds</code> an instance of <code>DynamicalSystem</code>: return the state of <code>ds</code> at time <code>t</code>. For continuous time systems this interpolates and extrapolates, while for discrete time systems it only works if <code>t</code> is the current time.</li><li><a href="@ref"><code>current_state</code></a></li><li><a href="@ref"><code>initial_state</code></a></li><li><a href="@ref"><code>observe_state</code></a></li><li><a href="@ref"><code>current_parameters</code></a></li><li><a href="@ref"><code>current_parameter</code></a></li><li><a href="@ref"><code>initial_parameters</code></a></li><li><a href="@ref"><code>isdeterministic</code></a></li><li><a href="@ref"><code>isdiscretetime</code></a></li><li><a href="@ref"><code>dynamic_rule</code></a></li><li><a href="@ref"><code>current_time</code></a></li><li><a href="@ref"><code>initial_time</code></a></li><li><a href="@ref"><code>isinplace</code></a></li><li><a href="@ref"><code>successful_step</code></a></li><li><a href="@ref"><code>referrenced_sciml_model</code></a></li></ul><p><strong>API - alter status</strong></p><ul><li><a href="@ref"><code>reinit!</code></a></li><li><a href="@ref"><code>set_state!</code></a></li><li><a href="@ref"><code>set_parameter!</code></a></li><li><a href="@ref"><code>set_parameters!</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/DynamicalSystemsBase.jl/blob/v3.10.1/src/core/dynamicalsystem_interface.jl#L4-L105">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DynamicalSystemsBase.DeterministicIteratedMap" href="#DynamicalSystemsBase.DeterministicIteratedMap"><code>DynamicalSystemsBase.DeterministicIteratedMap</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">DeterministicIteratedMap &lt;: DiscreteTimeDynamicalSystem
DeterministicIteratedMap(f, u0, p = nothing; t0 = 0)</code></pre><p>A deterministic discrete time dynamical system defined by an iterated map as follows:</p><p class="math-container">\[\vec{u}_{n+1} = \vec{f}(\vec{u}_n, p, n)\]</p><p>An alias for <code>DeterministicIteratedMap</code> is <code>DiscreteDynamicalSystem</code>.</p><p>Optionally configure the parameter container <code>p</code> and initial time <code>t0</code>.</p><p>For construction instructions regarding <code>f, u0</code> see the DynamicalSystems.jl tutorial.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/DynamicalSystemsBase.jl/blob/v3.10.1/src/core_systems/discrete_time_map.jl#L7-L20">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DynamicalSystemsBase.CoupledODEs" href="#DynamicalSystemsBase.CoupledODEs"><code>DynamicalSystemsBase.CoupledODEs</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">CoupledODEs &lt;: ContinuousTimeDynamicalSystem
CoupledODEs(f, u0 [, p]; diffeq, t0 = 0.0)</code></pre><p>A deterministic continuous time dynamical system defined by a set of coupled ordinary differential equations as follows:</p><p class="math-container">\[\frac{d\vec{u}}{dt} = \vec{f}(\vec{u}, p, t)\]</p><p>An alias for <code>CoupledODE</code> is <code>ContinuousDynamicalSystem</code>.</p><p>Optionally provide the parameter container <code>p</code> and initial time as keyword <code>t0</code>.</p><p>For construction instructions regarding <code>f, u0</code> see the DynamicalSystems.jl tutorial.</p><p><strong>DifferentialEquations.jl interfacing</strong></p><p>The ODEs are evolved via the solvers of DifferentialEquations.jl. When initializing a <code>CoupledODEs</code>, you can specify the solver that will integrate <code>f</code> in time, along with any other integration options, using the <code>diffeq</code> keyword. For example you could use <code>diffeq = (abstol = 1e-9, reltol = 1e-9)</code>. If you want to specify a solver, do so by using the keyword <code>alg</code>, e.g.: <code>diffeq = (alg = Tsit5(), reltol = 1e-6)</code>. This requires you to have been first <code>using OrdinaryDiffEq</code> (or smaller library package such as <code>OrdinaryDiffEqVerner</code>) to access the solvers. The default <code>diffeq</code> is:</p><p>(alg = OrdinaryDiffEqTsit5.Tsit5{typeof(OrdinaryDiffEqCore.trivial<em>limiter!), typeof(OrdinaryDiffEqCore.trivial</em>limiter!), Static.False}(OrdinaryDiffEqCore.trivial<em>limiter!, OrdinaryDiffEqCore.trivial</em>limiter!, static(false)), abstol = 1.0e-6, reltol = 1.0e-6)</p><p><code>diffeq</code> keywords can also include <code>callback</code> for <a href="http://docs.juliadiffeq.org/latest/features/callback_functions.html">event handling </a>.</p><p>The convenience constructors <code>CoupledODEs(prob::ODEProblem [, diffeq])</code> and <code>CoupledODEs(ds::CoupledODEs [, diffeq])</code> are also available. Use <code>ODEProblem(ds::CoupledODEs, tspan = (t0, Inf))</code> to obtain the problem.</p><p>To integrate with ModelingToolkit.jl, the dynamical system <strong>must</strong> be created via the <code>ODEProblem</code> (which itself is created via ModelingToolkit.jl), see the Tutorial for an example.</p><p>Dev note: <code>CoupledODEs</code> is a light wrapper of <code>ODEIntegrator</code> from DifferentialEquations.jl.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/DynamicalSystemsBase.jl/blob/v3.10.1/src/core_systems/continuous_time_ode.jl#L26-L66">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DynamicalSystemsBase.CoreDynamicalSystem" href="#DynamicalSystemsBase.CoreDynamicalSystem"><code>DynamicalSystemsBase.CoreDynamicalSystem</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">CoreDynamicalSystem</code></pre><p>Union type meaning either <a href="#DynamicalSystemsBase.DeterministicIteratedMap"><code>DeterministicIteratedMap</code></a> or <a href="#DynamicalSystemsBase.CoupledODEs"><code>CoupledODEs</code></a>, which are the core systems whose dynamic rule <code>f</code> is known analytically.</p><p>This type is used for deciding whether a creation of a <a href="#DynamicalSystemsBase.TangentDynamicalSystem"><code>TangentDynamicalSystem</code></a> is possible or not.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/DynamicalSystemsBase.jl/blob/v3.10.1/src/core_systems/additional_supertypes.jl#L3-L11">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DynamicalSystemsBase.StroboscopicMap" href="#DynamicalSystemsBase.StroboscopicMap"><code>DynamicalSystemsBase.StroboscopicMap</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">StroboscopicMap &lt;: DiscreteTimeDynamicalSystem
StroboscopicMap(ds::CoupledODEs, period::Real) → smap
StroboscopicMap(period::Real, f, u0, p = nothing; kwargs...)</code></pre><p>A discrete time dynamical system that produces iterations of a time-dependent (non-autonomous) <a href="#DynamicalSystemsBase.CoupledODEs"><code>CoupledODEs</code></a> system exactly over a given <code>period</code>. The second signature first creates a <a href="#DynamicalSystemsBase.CoupledODEs"><code>CoupledODEs</code></a> and then calls the first.</p><p><code>StroboscopicMap</code> follows the <a href="#DynamicalSystemsBase.DynamicalSystem"><code>DynamicalSystem</code></a> interface. In addition, the function <code>set_period!(smap, period)</code> is provided, that sets the period of the system to a new value (as if it was a parameter). As this system is in discrete time, <a href="@ref"><code>current_time</code></a> and <a href="@ref"><code>initial_time</code></a> are integers. The initial time is always 0, because <code>current_time</code> counts elapsed periods. Call these functions on the <code>parent</code> of <code>StroboscopicMap</code> to obtain the corresponding continuous time. In contrast, <a href="@ref"><code>reinit!</code></a> expects <code>t0</code> in continuous time.</p><p>The convenience constructor</p><pre><code class="language-julia hljs">StroboscopicMap(T::Real, f, u0, p = nothing; diffeq, t0 = 0) → smap</code></pre><p>is also provided.</p><p>See also <a href="#DynamicalSystemsBase.PoincareMap"><code>PoincareMap</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/DynamicalSystemsBase.jl/blob/v3.10.1/src/derived_systems/stroboscopic_map.jl#L6-L31">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DynamicalSystemsBase.PoincareMap" href="#DynamicalSystemsBase.PoincareMap"><code>DynamicalSystemsBase.PoincareMap</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">PoincareMap &lt;: DiscreteTimeDynamicalSystem
PoincareMap(ds::CoupledODEs, plane; kwargs...) → pmap</code></pre><p>A discrete time dynamical system that produces iterations over the Poincaré map<sup class="footnote-reference"><a id="citeref-DatserisParlitz2022" href="#footnote-DatserisParlitz2022">[DatserisParlitz2022]</a></sup> of the given continuous time <code>ds</code>. This map is defined as the sequence of points on the Poincaré surface of section, which is defined by the <code>plane</code> argument.</p><p>Iterating <code>pmap</code> also mutates <code>ds</code> which is referrenced in <code>pmap</code>.</p><p>See also <a href="#DynamicalSystemsBase.StroboscopicMap"><code>StroboscopicMap</code></a>, <a href="@ref"><code>poincaresos</code></a>.</p><p><strong>Keyword arguments</strong></p><ul><li><code>direction = -1</code>: Only crossings with <code>sign(direction)</code> are considered to belong to the surface of section. Negative direction means going from less than <span>$b$</span> to greater than <span>$b$</span>.</li><li><code>u0 = nothing</code>: Specify an initial state.</li><li><code>rootkw = (xrtol = 1e-6, atol = 1e-8)</code>: A <code>NamedTuple</code> of keyword arguments passed to <code>find_zero</code> from <a href="https://github.com/JuliaMath/Roots.jl">Roots.jl</a>.</li><li><code>Tmax = 1e3</code>: The argument <code>Tmax</code> exists so that the integrator can terminate instead of being evolved for infinite time, to avoid cases where iteration would continue forever for ill-defined hyperplanes or for convergence to fixed points, where the trajectory would never cross again the hyperplane. If during one <code>step!</code> the system has been evolved for more than <code>Tmax</code>, then <code>step!(pmap)</code> will terminate and error.</li></ul><p><strong>Description</strong></p><p>The Poincaré surface of section is defined as sequential transversal crossings a trajectory has with any arbitrary manifold, but here the manifold must be a hyperplane. <code>PoincareMap</code> iterates over the crossings of the section.</p><p>If the state of <code>ds</code> is <span>$\mathbf{u} = (u_1, \ldots, u_D)$</span> then the equation defining a hyperplane is</p><p class="math-container">\[a_1u_1 + \dots + a_Du_D = \mathbf{a}\cdot\mathbf{u}=b\]</p><p>where <span>$\mathbf{a}, b$</span> are the parameters of the hyperplane.</p><p>In code, <code>plane</code> can be either:</p><ul><li>A <code>Tuple{Int, &lt;: Real}</code>, like <code>(j, r)</code>: the plane is defined as when the <code>j</code>th variable of the system equals the value <code>r</code>.</li><li>A vector of length <code>D+1</code>. The first <code>D</code> elements of the vector correspond to <span>$\mathbf{a}$</span> while the last element is <span>$b$</span>.</li></ul><p><code>PoincareMap</code> uses <code>ds</code>, higher order interpolation from DifferentialEquations.jl, and root finding from Roots.jl, to create a high accuracy estimate of the section.</p><p><code>PoincareMap</code> follows the <a href="#DynamicalSystemsBase.DynamicalSystem"><code>DynamicalSystem</code></a> interface with the following adjustments:</p><ol><li><code>dimension(pmap) == dimension(ds)</code>, even though the Poincaré map is effectively 1 dimension less.</li><li>Like <a href="#DynamicalSystemsBase.StroboscopicMap"><code>StroboscopicMap</code></a> time is discrete and counts the iterations on the surface of section. <a href="@ref"><code>initial_time</code></a> is always <code>0</code> and <a href="@ref"><code>current_time</code></a> is current iteration number.</li><li>A new function <a href="@ref"><code>current_crossing_time</code></a> returns the real time corresponding to the latest crossing of the hyperplane. The corresponding state on the hyperplane is <code>current_state(pmap)</code> as expected.</li><li>For the special case of <code>plane</code> being a <code>Tuple{Int, &lt;:Real}</code>, a special <code>reinit!</code> method is allowed with input state of length <code>D-1</code> instead of <code>D</code>, i.e., a reduced state already on the hyperplane that is then converted into the <code>D</code> dimensional state.</li></ol><p><strong>Example</strong></p><pre><code class="language-julia hljs">using DynamicalSystemsBase
ds = Systems.rikitake(zeros(3); μ = 0.47, α = 1.0)
pmap = poincaremap(ds, (3, 0.0))
step!(pmap)
next_state_on_psos = current_state(pmap)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/DynamicalSystemsBase.jl/blob/v3.10.1/src/derived_systems/poincare/poincaremap.jl#L14-L91">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DynamicalSystemsBase.TangentDynamicalSystem" href="#DynamicalSystemsBase.TangentDynamicalSystem"><code>DynamicalSystemsBase.TangentDynamicalSystem</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">TangentDynamicalSystem &lt;: DynamicalSystem
TangentDynamicalSystem(ds::CoreDynamicalSystem; kwargs...)</code></pre><p>A dynamical system that bundles the evolution of <code>ds</code> (which must be an <a href="#DynamicalSystemsBase.CoreDynamicalSystem"><code>CoreDynamicalSystem</code></a>) and <code>k</code> deviation vectors that are evolved according to the <em>dynamics in the tangent space</em> (also called linearized dynamics or the tangent dynamics).</p><p>The state of <code>ds</code> <strong>must</strong> be an <code>AbstractVector</code> for <code>TangentDynamicalSystem</code>.</p><p><code>TangentDynamicalSystem</code> follows the <a href="#DynamicalSystemsBase.DynamicalSystem"><code>DynamicalSystem</code></a> interface with the following adjustments:</p><ul><li><code>reinit!</code> takes an additional keyword <code>Q0</code> (with same default as below)</li><li>The additional functions <a href="@ref"><code>current_deviations</code></a> and <a href="@ref"><code>set_deviations!</code></a> are provided for the deviation vectors.</li></ul><p><strong>Keyword arguments</strong></p><ul><li><code>k</code> or <code>Q0</code>: <code>Q0</code> represents the initial deviation vectors (each column = 1 vector). If <code>k::Int</code> is given, a matrix <code>Q0</code> is created with the first <code>k</code> columns of the identity matrix. Otherwise <code>Q0</code> can be given directly as a matrix. It must hold that <code>size(Q, 1) == dimension(ds)</code>. You can use <a href="@ref"><code>orthonormal</code></a> for random orthonormal vectors. By default <code>k = dimension(ds)</code> is used.</li><li><code>u0 = current_state(ds)</code>: Starting state.</li><li><code>J</code> and <code>J0</code>: See section &quot;Jacobian&quot; below.</li></ul><p><strong>Description</strong></p><p>Let <span>$u$</span> be the state of <code>ds</code>, and <span>$y$</span> a deviation (or perturbation) vector. These two are evolved in parallel according to</p><p class="math-container">\[\begin{array}{rcl}
\frac{d\vec{x}}{dt} &amp;=&amp; f(\vec{x}) \\
\frac{dY}{dt} &amp;=&amp; J_f(\vec{x}) \cdot Y
\end{array}
\quad \mathrm{or}\quad
\begin{array}{rcl}
\vec{x}_{n+1} &amp;=&amp; f(\vec{x}_n) \\
Y_{n+1} &amp;=&amp; J_f(\vec{x}_n) \cdot Y_n.
\end{array}\]</p><p>for continuous or discrete time respectively. Here <span>$f$</span> is the <a href="@ref"><code>dynamic_rule</code></a><code>(ds)</code> and <span>$J_f$</span> is the Jacobian of <span>$f$</span>.</p><p><strong>Jacobian</strong></p><p>The keyword <code>J</code> provides the Jacobian function. It must be a Julia function in the same form as <code>f</code>, the <a href="@ref"><code>dynamic_rule</code></a>. Specifically, <code>J(u, p, n) -&gt; M::SMatrix</code> for the out-of-place version or <code>J(M, u, p, n)</code> for the in-place version acting in-place on <code>M</code>. In both cases <code>M</code> is the Jacobian matrix used for the evolution of the deviation vectors.</p><p>By default <code>J = nothing</code>.  In this case <code>J</code> is constructed automatically using the module <a href="https://github.com/JuliaDiff/ForwardDiff.jl"><code>ForwardDiff</code></a>, hence its limitations also apply here. Even though <code>ForwardDiff</code> is very fast, depending on your exact system you might gain significant speed-up by providing a hand-coded Jacobian and so it is recommended. Additionally, automatic and in-place Jacobians cannot be time dependent.</p><p>The keyword <code>J0</code> allows you to pass an initialized Jacobian matrix <code>J0</code>. This is useful for large in-place systems where only a few components of the Jacobian change during the time evolution. <code>J0</code> can be a sparse or any other matrix type. If not given, a matrix of zeros is used. <code>J0</code> is ignored for out of place systems.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/DynamicalSystemsBase.jl/blob/v3.10.1/src/derived_systems/tangent_space.jl#L15-L83">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DynamicalSystemsBase.ParallelDynamicalSystem" href="#DynamicalSystemsBase.ParallelDynamicalSystem"><code>DynamicalSystemsBase.ParallelDynamicalSystem</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ParallelDynamicalSystem &lt;: DynamicalSystem
ParallelDynamicalSystem(ds::DynamicalSystem, states::Vector{&lt;:AbstractArray})</code></pre><p>A struct that evolves several <code>states</code> of a given dynamical system in parallel <strong>at exactly the same times</strong>. Useful when wanting to evolve several different trajectories of the same system while ensuring that they share parameters and time vector.</p><p>This struct follows the <a href="#DynamicalSystemsBase.DynamicalSystem"><code>DynamicalSystem</code></a> interface with the following adjustments:</p><ul><li>The function <a href="@ref"><code>current_state</code></a> is called as <code>current_state(pds, i::Int = 1)</code> which returns the <code>i</code>th state. Same for <a href="@ref"><code>initial_state</code></a>.</li><li>Similarly, <a href="@ref"><code>set_state!</code></a> obtains a third argument <code>i::Int = 1</code> to set the <code>i</code>-th state.</li><li><a href="@ref"><code>current_states</code></a> and <a href="@ref"><code>initial_states</code></a> can be used to get all parallel states.</li><li><a href="@ref"><code>reinit!</code></a> takes in a vector of states (like <code>states</code>) for <code>u</code>.</li></ul><pre><code class="nohighlight hljs">ParallelDynamicalSystem(ds::DynamicalSystem, states::Vector{&lt;:Dict})</code></pre><p>For a dynamical system referring a MTK model, one can specify states as a vector of dictionaries to alter the current state of <code>ds</code> as in <a href="@ref"><code>set_state!</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/DynamicalSystemsBase.jl/blob/v3.10.1/src/derived_systems/parallel_systems.jl#L9-L33">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DynamicalSystemsBase.ProjectedDynamicalSystem" href="#DynamicalSystemsBase.ProjectedDynamicalSystem"><code>DynamicalSystemsBase.ProjectedDynamicalSystem</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ProjectedDynamicalSystem &lt;: DynamicalSystem
ProjectedDynamicalSystem(ds::DynamicalSystem, projection, complete_state)</code></pre><p>A dynamical system that represents a projection of an existing <code>ds</code> on a (projected) space.</p><p>The <code>projection</code> defines the projected space. If <code>projection isa AbstractVector{Int}</code>, then the projected space is simply the variable indices that <code>projection</code> contains. Otherwise, <code>projection</code> can be an arbitrary function that given the state of the original system <code>ds</code>, returns the state in the projected space. In this case the projected space can be equal, or even higher-dimensional, than the original.</p><p><code>complete_state</code> produces the state for the original system from the projected state. <code>complete_state</code> can always be a function that given the projected state returns a state in the original space. However, if <code>projection isa AbstractVector{Int}</code>, then <code>complete_state</code> can also be a vector that contains the values of the <em>remaining</em> variables of the system, i.e., those <em>not</em> contained in the projected space. In this case the projected space needs to be lower-dimensional than the original.</p><p>Notice that <code>ProjectedDynamicalSystem</code> does not require an invertible projection, <code>complete_state</code> is only used during <a href="@ref"><code>reinit!</code></a>. <code>ProjectedDynamicalSystem</code> is in fact a rather trivial wrapper of <code>ds</code> which steps it as normal in the original state space and only projects as a last step, e.g., during <a href="@ref"><code>current_state</code></a>.</p><p><strong>Examples</strong></p><p>Case 1: project 5-dimensional system to its last two dimensions.</p><pre><code class="language-julia hljs">ds = Systems.lorenz96(5)
projection = [4, 5]
complete_state = [0.0, 0.0, 0.0] # completed state just in the plane of last two dimensions
prods = ProjectedDynamicalSystem(ds, projection, complete_state)
reinit!(prods, [0.2, 0.4])
step!(prods)
current_state(prods)</code></pre><p>Case 2: custom projection to general functions of state.</p><pre><code class="language-julia hljs">ds = Systems.lorenz96(5)
projection(u) = [sum(u), sqrt(u[1]^2 + u[2]^2)]
complete_state(y) = repeat([y[1]/5], 5)
prods = # same as in above example...</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/DynamicalSystemsBase.jl/blob/v3.10.1/src/derived_systems/projected_system.jl#L6-L49">source</a></section></article><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>reinit!(::DynamicalSystem, args...; kwargs...)</code>. Check Documenter&#39;s build log for details.</p></div></div><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-DatserisParlitz2022"><a class="tag is-link" href="#citeref-DatserisParlitz2022">DatserisParlitz2022</a>Datseris &amp; Parlitz 2022, <em>Nonlinear Dynamics: A Concise Introduction Interlaced with Code</em>, <a href="https://doi.org/10.1007/978-3-030-91032-7">Springer Nature, Undergrad. Lect. Notes In Physics</a></li></ul></section></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="orbitdiagram/">Orbit diagrams »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Monday 23 September 2024 12:16">Monday 23 September 2024</span>. Using Julia version 1.10.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
