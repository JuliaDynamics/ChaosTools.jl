<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Rare events · ChaosTools.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="https://fonts.googleapis.com/css?family=Montserrat|Source+Code+Pro&amp;display=swap" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">ChaosTools.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">ChaosTools.jl</a></li><li><a class="tocitem" href="../orbitdiagram/">Orbit diagrams</a></li><li><a class="tocitem" href="../lyapunovs/">Lyapunov Exponents</a></li><li><a class="tocitem" href="../chaos_detection/">Detecting &amp; Categorizing Chaos</a></li><li><a class="tocitem" href="../dimreduction/">Dimensionality reduction</a></li><li><a class="tocitem" href="../periodicity/">Fixed points &amp; Periodicity</a></li><li class="is-active"><a class="tocitem" href>Rare events</a><ul class="internal"><li><a class="tocitem" href="#Return-time-statistics"><span>Return time statistics</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Rare events</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Rare events</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaDynamics/ChaosTools.jl/blob/main/docs/src/rareevents.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Rare-events"><a class="docs-heading-anchor" href="#Rare-events">Rare events</a><a id="Rare-events-1"></a><a class="docs-heading-anchor-permalink" href="#Rare-events" title="Permalink"></a></h1><h2 id="Return-time-statistics"><a class="docs-heading-anchor" href="#Return-time-statistics">Return time statistics</a><a id="Return-time-statistics-1"></a><a class="docs-heading-anchor-permalink" href="#Return-time-statistics" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="ChaosTools.mean_return_times" href="#ChaosTools.mean_return_times"><code>ChaosTools.mean_return_times</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">mean_return_times(ds::DynamicalSystem, u₀, εs, T; kwargs...) → τ, c</code></pre><p>Return the mean return times <code>τ</code>, as well as the amount of returns <code>c</code>, for subsets of the state space of <code>ds</code> defined by <code>u₀, εs</code>. The <code>ds</code> is evolved for a maximum of <code>T</code> time.</p><p>This function is a convenience wrapper around calls to <a href="#ChaosTools.exit_entry_times"><code>exit_entry_times</code></a> and then to <a href="@ref"><code>transit_return</code></a> and then some averaging. Thus see <a href="#ChaosTools.exit_entry_times"><code>exit_entry_times</code></a> for the meaning of <code>u₀</code> and <code>εs</code> and further info.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/ChaosTools.jl/blob/3afdac6b891328ca63c8e1ca31c8858dd8dafe98/src/rareevents/mean_return_times/mrt_api.jl#L119-L129">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ChaosTools.exit_entry_times" href="#ChaosTools.exit_entry_times"><code>ChaosTools.exit_entry_times</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">exit_entry_times(ds::DynamicalSystem, u₀, εs, T; kwargs...) → exits, entries</code></pre><p>Collect exit and entry times for balls or boxes centered at <code>u₀</code> with radii <code>εs</code>, in the state space of the given dynamical system. Return the exit and (re-)entry return times to the set(s), where each of these is a vector containing all collected times for the respective <code>ε</code>-radius set, for <code>ε ∈ εs</code>. The dynamical system is evolved up to <code>T</code> total time.</p><p>Use <code>transit_return_times(exits, entries)</code> to transform the output into transit and return times, and see also <a href="#ChaosTools.mean_return_times"><code>mean_return_times</code></a>.</p><p>The keyword <code>show_progress</code> displays a progress bar. It is <code>false</code> for discrete and <code>true</code> for continuous systems by default.</p><p><strong>Description</strong></p><p>Transit and return time statistics are important for the transport properties of dynamical systems<sup class="footnote-reference"><a id="citeref-Meiss1997" href="#footnote-Meiss1997">[Meiss1997]</a></sup> and can be connected with fractal dimensions of chaotic sets<sup class="footnote-reference"><a id="citeref-Boev2014" href="#footnote-Boev2014">[Boev2014]</a></sup>.</p><p>The current algorithm collects exit and re-entry times to given sets in the state space, which are centered at the state <code>u₀</code>. <strong>The system evolution always starts from <code>u₀</code></strong> and the initial state of <code>ds</code> is irrelevant. <code>εs</code> is always a <code>Vector</code>.</p><p><strong>Specification of sets to return to</strong></p><p>If each entry of <code>εs</code> is a real number, then sets around <code>u₀</code> are nested hyper-spheres of radius <code>ε ∈ εs</code>. The sets can also be hyper-rectangles (boxes), if each entry of <code>εs</code> is a vector itself. Then, the <code>i</code>-th box is defined by the space covered by <code>u0 .± εs[i]</code> (thus the actual box size is <code>2εs[i]</code>!). In the future, state space sets will be specified more conveniently and a single argument <code>sets</code> will be given instead of <code>u₀, εs</code>.</p><p>The reason to input multiple <code>εs</code> at once is purely for performance optimization (much faster than doing each <code>ε</code> individually).</p><p><strong>Discrete time systems</strong></p><p>For discrete systems, exit time is recorded immediately after exiting of the set, and re-entry is recorded immediately on re-entry. This means that if an orbit needs 1 step to leave the set and then it re-enters immediately on the next step, the return time is 1.</p><p><strong>Continuous time systems</strong></p><p>For continuous systems, a steppable integrator supporting interpolation is used. The way to specify how to estimate exit and entry times is via the keyword <code>crossing_method</code> whose values can be:</p><ol><li><code>CrossingLinearIntersection()</code>: Linear interpolation is used between integrator steps and the intersection between lines and spheres is used to find the crossing times.</li><li><code>CrossingAccurateInterpolation(; abstol=1e-12, reltol=1e-6)</code>: Extremely accurate high order interpolation is used between integrator steps. First, a minimization with Optim.jl finds the minimum distance of the trajectory to the set center. Then, Roots.jl is used to find the exact crossing point. The tolerances are given to both procedures.</li></ol><p>Clearly, <code>CrossingAccurateInterpolation</code> is much more accurate than <code>CrossingLinearIntersection</code>, but also much slower. However, the smaller the steps the integrator takes (in case some very high accuracy solver is used), the closer the linear intersection gets to the accurate version. Benchmarks are advised for the individual specific case the algorithm is applied at, in order to choose the best method.</p><p>The keyword <code>threshold_distance = Inf</code> provides a means to skip the interpolation check, if the current state of the integrator is too far from the set center. If the distance of the current state of the integrator is <code>threshold_distance</code> or more distance away from the set center, attempts to interpolate are skipped. By default <code>threshold_distance = Inf</code> and hence this never happens. Typically you&#39;d want this to be 10-100 times the distance the trajectory covers at an average integrator step.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/ChaosTools.jl/blob/3afdac6b891328ca63c8e1ca31c8858dd8dafe98/src/rareevents/mean_return_times/mrt_api.jl#L5-L83">source</a></section></article><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-Meiss1997"><a class="tag is-link" href="#citeref-Meiss1997">Meiss1997</a>Meiss, J. D. <em>Average exit time for volume-preserving maps</em>, <a href="https://doi.org/10.1063/1.166245">Chaos (1997)</a></li><li class="footnote" id="footnote-Boev2014"><a class="tag is-link" href="#citeref-Boev2014">Boev2014</a>Boev, Vadivasova, &amp; Anishchenko, <em>Poincaré recurrence statistics as an indicator of chaos synchronization</em>, <a href="https://doi.org/10.1063/1.4873721">Chaos (2014)</a></li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../periodicity/">« Fixed points &amp; Periodicity</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Friday 8 September 2023 10:00">Friday 8 September 2023</span>. Using Julia version 1.9.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
