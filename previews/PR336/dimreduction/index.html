<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Dimensionality reduction · ChaosTools.jl</title><meta name="title" content="Dimensionality reduction · ChaosTools.jl"/><meta property="og:title" content="Dimensionality reduction · ChaosTools.jl"/><meta property="twitter:title" content="Dimensionality reduction · ChaosTools.jl"/><meta name="description" content="Documentation for ChaosTools.jl."/><meta property="og:description" content="Documentation for ChaosTools.jl."/><meta property="twitter:description" content="Documentation for ChaosTools.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="https://fonts.googleapis.com/css?family=Montserrat|Source+Code+Pro&amp;display=swap" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">ChaosTools.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">ChaosTools.jl</a></li><li><a class="tocitem" href="../orbitdiagram/">Orbit diagrams</a></li><li><a class="tocitem" href="../lyapunovs/">Lyapunov Exponents</a></li><li><a class="tocitem" href="../chaos_detection/">Detecting &amp; Categorizing Chaos</a></li><li class="is-active"><a class="tocitem" href>Dimensionality reduction</a><ul class="internal"><li><a class="tocitem" href="#Broomhead-King-Coordinates"><span>Broomhead-King Coordinates</span></a></li><li><a class="tocitem" href="#DyCA-Dynamical-Component-Analysis"><span>DyCA - Dynamical Component Analysis</span></a></li></ul></li><li><a class="tocitem" href="../periodicity/">Fixed points &amp; Periodicity</a></li><li><a class="tocitem" href="../rareevents/">Rare events</a></li><li><a class="tocitem" href="../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Dimensionality reduction</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Dimensionality reduction</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaDynamics/ChaosTools.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaDynamics/ChaosTools.jl/blob/main/docs/src/dimreduction.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Dimensionality-reduction"><a class="docs-heading-anchor" href="#Dimensionality-reduction">Dimensionality reduction</a><a id="Dimensionality-reduction-1"></a><a class="docs-heading-anchor-permalink" href="#Dimensionality-reduction" title="Permalink"></a></h1><h2 id="Broomhead-King-Coordinates"><a class="docs-heading-anchor" href="#Broomhead-King-Coordinates">Broomhead-King Coordinates</a><a id="Broomhead-King-Coordinates-1"></a><a class="docs-heading-anchor-permalink" href="#Broomhead-King-Coordinates" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ChaosTools.broomhead_king" href="#ChaosTools.broomhead_king"><code>ChaosTools.broomhead_king</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">broomhead_king(s::AbstractVector, d::Int) -&gt; U, S, Vtr</code></pre><p>Return the Broomhead-King coordinates of a timeseries <code>s</code> by performing <code>svd</code> on high-dimensional delay embedding if <code>s</code> with dimension <code>d</code> with minimum delay.</p><p><strong>Description</strong></p><p>Broomhead and King coordinates is an approach proposed in <sup class="footnote-reference"><a id="citeref-Broomhead1987" href="#footnote-Broomhead1987">[Broomhead1987]</a></sup> that applies the Karhunen–Loève theorem to delay coordinates embedding with smallest possible delay.</p><p>The function performs singular value decomposition on the <code>d</code>-dimensional matrix <span>$X$</span> of <span>$s$</span>,</p><p class="math-container">\[X = \frac{1}{\sqrt{N}}\left(
\begin{array}{cccc}
x_1 &amp; x_2 &amp; \ldots &amp; x_d \\
x_2 &amp; x_3 &amp; \ldots &amp; x_{d+1}\\
\vdots &amp; \vdots &amp; \vdots &amp; \vdots \\
x_{N-d+1} &amp; x_{N-d+2} &amp;\ldots &amp; x_N
\end{array}
\right) = U\cdot S \cdot V^{tr}.\]</p><p>where <span>$x := s - \bar{s}$</span>. The columns of <span>$U$</span> can then be used as a new coordinate system, and by considering the values of the singular values <span>$S$</span> you can decide how many columns of <span>$U$</span> are &quot;important&quot;.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/ChaosTools.jl/blob/5476f7189a2463c787efac71c75bddd9cdce8531/src/dimreduction/broomhead_king.jl#L7-L37">source</a></section></article><p>This alternative/improvement of the traditional delay coordinates can be a very powerful tool. An example where it shines is noisy data where there is the effect of superficial dimensions due to noise.</p><p>Take the following example where we produce noisy data from a system and then use Broomhead-King coordinates as an alternative to &quot;vanilla&quot; delay coordinates:</p><pre><code class="language-julia hljs">using ChaosTools, CairoMakie

function gissinger_rule(u, p, t)
    μ, ν, Γ = p
    du1 = μ*u[1] - u[2]*u[3]
    du2 = -ν*u[2] + u[1]*u[3]
    du3 = Γ - u[3] + u[1]*u[2]
    return SVector{3}(du1, du2, du3)
end

gissinger = CoupledODEs(gissinger_rule, ones(3), [0.112, 0.1, 0.9])
X, t = trajectory(gissinger, 1000.0; Ttr = 100, Δt = 0.1)
x = X[:, 1]

L = length(x)
s = x .+ 0.5rand(L) #add noise

U, S = broomhead_king(s, 20)
summary(U)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">&quot;9982×20 Matrix{Float64}&quot;</code></pre><p>Now let&#39;s simply compare the above result with the one you get from doing a standard delay coordinates embedding</p><pre><code class="language-julia hljs">using DelayEmbeddings: embed, estimate_delay

fig = Figure()
axs = [Axis3(fig[1, i]) for i in 1:2]
lines!(axs[1], U[:, 1], U[:, 2], U[:, 3])
axs[1].title = &quot;Broomhead-King of s&quot;

R = embed(s, 3, estimate_delay(x, &quot;mi_min&quot;))
lines!(axs[2], columns(R)...)
axs[2].title = &quot;2D embedding of s&quot;
fig</code></pre><img src="3b9f4978.png" alt="Example block output"/><p>we have used the same system as in the <a href="@ref">Delay Coordinates Embedding</a> example, and picked the optimal delay time of <code>τ = 30</code> (for same <code>Δt = 0.05</code>). Regardless, the vanilla delay coordinates is much worse than the Broomhead-King coordinates.</p><h2 id="DyCA-Dynamical-Component-Analysis"><a class="docs-heading-anchor" href="#DyCA-Dynamical-Component-Analysis">DyCA - Dynamical Component Analysis</a><a id="DyCA-Dynamical-Component-Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#DyCA-Dynamical-Component-Analysis" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ChaosTools.dyca" href="#ChaosTools.dyca"><code>ChaosTools.dyca</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">dyca(data, eig_threshold) -&gt; eigenvalues, proj_mat, projected_data</code></pre><p>Compute the Dynamical Component analysis (DyCA) of the given <code>data</code> <sup class="footnote-reference"><a id="citeref-Uhl2018" href="#footnote-Uhl2018">[Uhl2018]</a></sup> used for dimensionality reduction.</p><p>Return the eigenvalues, projection matrix, and reduced-dimension data (which are just <code>data*proj_mat</code>).</p><p><strong>Keyword Arguments</strong></p><ul><li>norm_eigenvectors=false : if true, normalize the eigenvectors</li></ul><p><strong>Description</strong></p><p>Dynamical Component Analysis (DyCA) is a method to detect projection vectors to reduce the dimensionality of multi-variate, high-dimensional deterministic datasets. Unlike methods like PCA or ICA that make a stochasticity assumption, DyCA relies on a determinacy assumption on the time-series and is based on the solution of a generalized eigenvalue problem. After choosing an appropriate eigenvalue threshold and solving the eigenvalue problem, the obtained eigenvectors are used to project the high-dimensional dataset onto a lower dimension. The obtained eigenvalues measure the quality of the assumption of linear determinism for the investigated data. Furthermore, the number of the generalized eigenvalues with a value of approximately 1.0 are a measure of the number of linear equations contained in the dataset. This property is useful in detecting regions with highly deterministic parts in the time-series and also as a preprocessing step for reservoir computing of high-dimensional spatio-temporal data.</p><p>The generalised eigenvalue problem we solve is:</p><p class="math-container">\[C_1 C_0^{-1} C_1^{\top} \bar{u} = \lambda C_2 \bar{u}
\]</p><p>where <span>$C_0$</span> is the correlation matrix of the data with itself, <span>$C_1$</span> the correlation matrix of the data with its derivative, and <span>$C_2$</span> the correlation matrix of the derivative of the data with itself. The eigenvectors <span>$\bar{u}$</span> with eigenvalues approximately 1 and their <span>$C_1^{-1} C_2 u$</span> counterpart, form the space where the data is projected onto.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/ChaosTools.jl/blob/5476f7189a2463c787efac71c75bddd9cdce8531/src/dimreduction/dyca.jl#L4-L45">source</a></section></article><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-Broomhead1987"><a class="tag is-link" href="#citeref-Broomhead1987">Broomhead1987</a>Broomhead, Jones, King, J. Phys. A <strong>20</strong>, 9, pp L563 (1987)</li><li class="footnote" id="footnote-Uhl2018"><a class="tag is-link" href="#citeref-Uhl2018">Uhl2018</a>B Seifert, K Korn, S Hartmann, C Uhl, <em>Dynamical Component Analysis (DYCA): Dimensionality Reduction for High-Dimensional Deterministic Time-Series</em>, 10.1109/mlsp.2018.8517024, 2018 IEEE 28th International Workshop on Machine Learning for Signal Processing (MLSP)</li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../chaos_detection/">« Detecting &amp; Categorizing Chaos</a><a class="docs-footer-nextpage" href="../periodicity/">Fixed points &amp; Periodicity »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Monday 23 September 2024 07:28">Monday 23 September 2024</span>. Using Julia version 1.10.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
